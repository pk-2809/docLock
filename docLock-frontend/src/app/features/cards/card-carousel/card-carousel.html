<!-- Card Carousel Component -->
<div class="relative h-full flex flex-col overflow-hidden">
    <div [id]="carouselId" (scroll)="scrollCarousel($event)" class="flex-1 min-h-0 overflow-x-auto overflow-y-hidden scrollbar-hide snap-x snap-mandatory scroll-smooth" style="scroll-padding: 0.5rem;">
        <div class="flex gap-4 py-2 px-2 items-center" style="width: max-content; height: 100%;">
            <div *ngFor="let card of cards; let i = index" class="flex-shrink-0 snap-center" style="width: clamp(222px, calc(30vh * 1.586), 318px);">
                <!-- Card Display -->
                <div class="w-full aspect-[1.586/1] rounded-2xl text-white shadow-xl relative overflow-hidden cursor-pointer active:scale-[0.98] transition-all duration-300 select-none transform"
                     style="padding: clamp(0.75rem, 2vw, 1.5rem);"
                     [class]="getCardGradient(card)"
                     [ngClass]="getCardScale(i) + ' ' + getCardOpacity(i)">
                    
                    <!-- Card Pattern Overlay -->
                    <div class="absolute inset-0 bg-gradient-to-tr from-white/10 to-transparent pointer-events-none"></div>
                    <div class="absolute top-3 right-3 px-2 py-1 bg-white/20 rounded-lg" style="font-size: clamp(0.625rem, 2vw, 0.75rem);">
                        <div class="font-bold whitespace-nowrap text-center">{{card.bankName || getBrandName()}}</div>
                    </div>
                    
                    <div class="relative z-10 flex flex-col justify-between h-full">
                        <div class="flex justify-between items-start">
                            <div [class.cursor-pointer]="i === selectedCardIndex" 
                                 [class.cursor-default]="i !== selectedCardIndex"
                                 (click)="onCopyToClipboard(card.name, 'Card name', i); $event.stopPropagation()">
                                <span class="text-xs font-medium opacity-80 uppercase tracking-wider">{{card.name}}</span>
                            </div>
                        </div>
                        
                        <div class="text-center my-3" 
                             [class.cursor-pointer]="i === selectedCardIndex"
                             [class.cursor-default]="i !== selectedCardIndex"
                             (click)="onCopyCardNumber(card, i); $event.stopPropagation()">
                            <p class="font-mono tracking-widest drop-shadow-sm" style="font-size: clamp(0.875rem, 4vw, 1.125rem);">
                                {{getMaskedCardNumber(card.number)}}
                            </p>
                        </div>

                        <div class="flex justify-between items-end">
                            <div [class.cursor-pointer]="i === selectedCardIndex"
                                 [class.cursor-default]="i !== selectedCardIndex"
                                 (click)="onCopyToClipboard(card.holderName || '', 'Card holder name', i); $event.stopPropagation()">
                                <p class="text-xs opacity-60 uppercase mb-1">Card Holder</p>
                                <p class="text-sm font-medium tracking-wide uppercase">{{card.holderName}}</p>
                            </div>
                            <div class="flex gap-4">
                                <div [class.cursor-pointer]="i === selectedCardIndex"
                                     [class.cursor-default]="i !== selectedCardIndex"
                                     (click)="onCopyToClipboard(card.expiryDate, 'Expiry date', i); $event.stopPropagation()">
                                    <p class="text-xs opacity-60 uppercase mb-1">Expires</p>
                                    <p class="font-mono text-sm">{{card.expiryDate}}</p>
                                </div>
                                <div [class.cursor-pointer]="i === selectedCardIndex"
                                     [class.cursor-default]="i !== selectedCardIndex"
                                     (click)="onCopyToClipboard(card.cvv, 'CVV', i); $event.stopPropagation()">
                                    <p class="text-xs opacity-60 uppercase mb-1">CVV</p>
                                    <p class="font-mono text-sm">{{getDisplayCVV(card)}}</p>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
    <!-- Carousel Indicators -->
    @if (cards.length > 1) {
    <div class="flex justify-center gap-2 mt-3 flex-shrink-0">
        @for (card of cards; track card.id; let i = $index) {
        <button (click)="scrollToCard(i)"
                class="rounded-full transition-all duration-300"
                [ngClass]="i === selectedCardIndex ? getIndicatorColorClasses() + ' w-6 h-1.5' : getIndicatorInactiveClasses() + ' w-1.5 h-1.5'">
        </button>
        }
    </div>
    }
</div>
