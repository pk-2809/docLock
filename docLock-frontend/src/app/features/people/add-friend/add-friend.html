<div class="min-h-screen bg-gradient-to-br from-pink-50 via-rose-50 to-purple-50 flex flex-col overflow-hidden relative">
    <!-- Pink top border line -->
    <div class="absolute top-0 left-0 right-0 h-1 bg-gradient-to-r from-pink-500 via-rose-500 to-pink-500 z-50"></div>
    
    <!-- Sophisticated Background Elements -->
    <div class="absolute inset-0 overflow-hidden pointer-events-none">
        <div class="absolute -top-32 -right-32 w-64 h-64 bg-gradient-to-br from-pink-400/10 to-rose-500/10 rounded-full animate-float-slow"></div>
        <div class="absolute -bottom-24 -left-24 w-48 h-48 bg-gradient-to-tr from-purple-400/8 to-pink-500/8 rounded-full animate-float-reverse"></div>
        <div class="absolute top-1/4 right-1/3 w-32 h-32 bg-gradient-to-br from-rose-300/6 to-pink-400/6 rounded-full animate-pulse-slow"></div>
        <div class="absolute bottom-1/3 left-1/4 w-20 h-20 bg-gradient-to-br from-slate-300/8 to-pink-300/8 rounded-full animate-float"></div>
    </div>

    <!-- Content Wrapper with Max Width -->
    <div class="w-full max-w-[639px] mx-auto flex flex-col relative z-10" style="height: calc(100vh - 5rem); max-height: calc(100vh - 5rem);">
    <!-- Mobile-First Header -->
    <header class="flex-none p-4 pt-12 mb-4">
        <div class="flex items-center justify-center mb-6 relative">
            <!-- Back Button -->
            <a routerLink="/friends"
                class="absolute left-0 w-10 h-10 rounded-xl bg-white/90 backdrop-blur-xl border border-white/60 shadow-lg flex items-center justify-center text-slate-500 active:text-slate-900 active:bg-white transition-all active:scale-95 touch-manipulation">
                <svg class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M10.5 19.5L3 12m0 0l7.5-7.5M3 12h18"/>
                </svg>
            </a>

            <!-- Centered Title -->
            <div class="text-center">
                <h1 class="text-xl font-bold text-slate-800 tracking-tight">Add Friend</h1>
            </div>
        </div>
    </header>

    <!-- Main Content -->
    <div class="flex-1 min-h-0 overflow-y-auto flex flex-col justify-center px-4 pb-24">
        <div class="max-w-sm mx-auto w-full">
            <!-- Icon and Title Section -->
            <div class="text-center mb-8 animate-fade-in">
                <div class="relative mb-8">
                    <div class="w-20 h-20 mx-auto bg-gradient-to-br from-pink-500 to-rose-600 rounded-3xl flex items-center justify-center shadow-xl shadow-pink-500/25 relative overflow-hidden">
                        <div class="absolute inset-0 bg-gradient-to-br from-pink-200/50 to-rose-200/50 animate-pulse"></div>
                        <svg class="w-10 h-10 text-white relative z-10" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="1.5"
                                d="M19 7.5v3m0 0v3m0-3h3m-3 0h-3m-2.25-4.125a3.375 3.375 0 11-6.75 0 3.375 3.375 0 016.75 0zM4 19.235v-.11a6.375 6.375 0 0112.75 0v.109A12.318 12.318 0 0110.374 21c-2.331 0-4.512-.645-6.374-1.766z"/>
                        </svg>
                    </div>
                    <!-- Floating decorative elements -->
                    <div class="absolute -top-2 -right-2 w-6 h-6 bg-pink-200 rounded-full animate-bounce delay-300"></div>
                    <div class="absolute -bottom-2 -left-2 w-4 h-4 bg-rose-200 rounded-full animate-bounce delay-700"></div>
                    <div class="absolute top-1/2 -left-4 w-3 h-3 bg-pink-300 rounded-full animate-pulse"></div>
                </div>
                
                <h2 class="text-2xl font-bold text-slate-900 mb-3">Connect with People</h2>
                <p class="text-slate-600 leading-relaxed font-medium">
                    Paste a User ID or profile link below to add them to your secure circle.
                </p>
            </div>

            <!-- Form Section -->
            <div class="space-y-6 animate-fade-in" style="animation-delay: 200ms;">
                <!-- Input Field -->
                <div>
                    <label class="block text-sm font-bold text-slate-900 mb-3">Profile Link or ID</label>
                    <div class="relative">
                        <div class="absolute inset-0 bg-gradient-to-r from-pink-500/5 to-rose-500/5 rounded-2xl"></div>
                        <input type="text" [(ngModel)]="profileUrl" name="profileUrl" autocomplete="off" autocorrect="off"
                            autocapitalize="off" spellcheck="false" inputmode="text" (contextmenu)="$event.preventDefault()"
                            class="relative w-full bg-white/90 backdrop-blur-xl border-2 border-white/60 rounded-2xl px-4 py-4 text-slate-800 placeholder-slate-500 focus:outline-none focus:border-pink-400 focus:ring-4 focus:ring-pink-500/10 transition-all font-mono text-sm shadow-lg"
                            placeholder="e.g. gV5I3sJf...">
                    </div>
                    
                    @if (profileUrl && !isValidInput()) {
                    <div class="flex items-center gap-2 mt-3 p-3 bg-red-50 border border-red-200 rounded-xl text-red-700 text-sm font-medium animate-fade-in">
                        <svg class="w-4 h-4 flex-shrink-0" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2"
                                d="M12 9v3m0 3h.01M21 12c0 4.97-4.03 9-9 9s-9-4.03-9-9 4.03-9 9-9 9 4.03 9 9z"></path>
                        </svg>
                        Invalid format
                    </div>
                    }
                </div>

                <!-- Feedback Messages -->
                @if (error()) {
                <div class="flex items-start gap-3 p-4 rounded-2xl bg-red-50 border border-red-200 text-red-700 text-sm animate-fade-in">
                    <div class="w-6 h-6 rounded-full bg-red-100 flex items-center justify-center shrink-0 mt-0.5">
                        <svg class="w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2"
                                d="M12 9v3m0 3h.01M21 12c0 4.97-4.03 9-9 9s-9-4.03-9-9 4.03-9 9-9 9 4.03 9 9z"></path>
                        </svg>
                    </div>
                    <div class="font-medium">{{ error() }}</div>
                </div>
                }

                @if (success()) {
                <div class="flex items-start gap-3 p-4 rounded-2xl bg-green-50 border border-green-200 text-green-700 text-sm animate-fade-in">
                    <div class="w-6 h-6 rounded-full bg-green-100 flex items-center justify-center shrink-0 mt-0.5">
                        <svg class="w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 12l2 2 4-4"></path>
                        </svg>
                    </div>
                    <div class="font-medium">{{ success() }}</div>
                </div>
                }

                <!-- Action Button -->
                <button (click)="initiateAddFriend()" [disabled]="isLoading() || !isValidInput()"
                    class="group w-full h-14 rounded-2xl bg-gradient-to-r from-pink-500 to-rose-600 active:from-pink-600 active:to-rose-700 text-white font-bold text-lg shadow-lg shadow-pink-500/25 active:shadow-pink-500/40 active:scale-[0.98] transition-all disabled:opacity-50 disabled:cursor-not-allowed disabled:active:scale-100 flex items-center justify-center relative overflow-hidden touch-manipulation">
                    <div class="absolute inset-0 bg-gradient-to-r from-white/0 via-white/20 to-white/0 -translate-x-full group-active:translate-x-full transition-transform duration-700"></div>
                    @if (!isLoading()) {
                    <span class="relative z-10">Add Friend</span>
                    }
                    @if (isLoading()) {
                    <div class="w-6 h-6 border-2 border-pink-200 border-t-white rounded-full animate-spin relative z-10"></div>
                    }
                </button>
            </div>
        </div>
    </div>
    </div>

    <!-- Confirmation Bottom Sheet -->
    @if (showConfirmation()) {
    <div class="fixed inset-0 z-50 flex items-end backdrop-blur-lg">
        <!-- Backdrop -->
        <div class="absolute inset-0 bg-black/50 transition-opacity" (click)="closeConfirmation()"></div>

        <!-- Bottom Sheet -->
        <div class="bg-white rounded-t-3xl w-full shadow-2xl overflow-hidden relative animate-slide-up">
            <!-- Handle -->
            <div class="flex justify-center pt-4 pb-2">
                <div class="w-12 h-1.5 bg-slate-300 rounded-full"></div>
            </div>

            <!-- Content -->
            <div class="p-6 pb-8 text-center">
                <!-- Profile Image or Avatar -->
                <div class="w-20 h-20 mx-auto mb-6 rounded-3xl overflow-hidden bg-gradient-to-br from-pink-100 to-rose-100 flex items-center justify-center">
                    @if (friendToConfirm()?.profileImage) {
                    <img [src]="friendToConfirm()?.profileImage" class="w-full h-full object-cover" alt="Profile">
                    } @else {
                    <div class="w-12 h-12 bg-gradient-to-br from-pink-500 to-rose-600 rounded-2xl flex items-center justify-center">
                        <svg class="w-6 h-6 text-white" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M16 7a4 4 0 11-8 0 4 4 0 018 0zM12 14a7 7 0 00-7 7h14a7 7 0 00-7-7z"/>
                        </svg>
                    </div>
                    }
                </div>

                <!-- Title -->
                <h3 class="text-2xl font-bold text-slate-900 mb-3">Found Them! âœ¨</h3>
                
                <!-- Message -->
                <p class="text-slate-600 font-medium mb-8">
                    You're about to add <span class="font-bold text-pink-600">{{ friendToConfirm()?.name || 'this user' }}</span> to your secure circle. Ready to start sharing?
                </p>

                <!-- Action Buttons -->
                <div class="space-y-3">
                    <button (click)="confirmAdd()"
                        class="w-full py-4 rounded-2xl bg-gradient-to-r from-pink-500 to-rose-600 text-white font-bold shadow-lg active:scale-[0.98] transition-all flex items-center justify-center gap-3 touch-manipulation">
                        <svg class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 4.5v15m7.5-7.5h-15"/>
                        </svg>
                        <span>Let's Connect</span>
                    </button>
                    
                    <button (click)="closeConfirmation()"
                        class="w-full py-4 text-slate-600 font-bold active:text-slate-800 transition-colors touch-manipulation">
                        Not yet
                    </button>
                </div>
            </div>
        </div>
    </div>
    }
</div>