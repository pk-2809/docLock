<div class="min-h-screen bg-blue-50">
    <!-- Dashboard View -->
    <div class="px-4 py-4 flex flex-col overflow-hidden" style="height: calc(100vh - 7rem); max-height: calc(100vh - 7rem);">
        <!-- Large Welcome Header -->
        <header class="flex justify-between items-center mb-4 flex-shrink-0">
            <div class="welcome-section">
                <h2 class="text-slate-500 text-sm uppercase tracking-wider font-bold mb-2">
                    Welcome back,
                </h2>
                <h1 class="font-black tracking-tight flex items-center gap-3 text-slate-900 name-heartbeat" style="font-size: 40px; line-height: 1.2;">
                    {{ firstName }}
                    <span class="w-4 h-4 rounded-full bg-indigo-500 animate-ping"></span>
                </h1>
            </div>

            <!-- Notification Bell -->
            <button (click)="onNotificationClick()" [disabled]="isFetchingNotifications"
                class="relative w-12 h-12 rounded-xl bg-white/80 backdrop-blur-sm border border-indigo-100 shadow-md flex items-center justify-center text-slate-400 hover:text-indigo-600 transition-all active:scale-95 disabled:opacity-70 disabled:cursor-not-allowed">

                @if (!isFetchingNotifications) {
                <svg class="w-6 h-6" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="1.5"
                        d="M14.857 17.082a23.848 23.848 0 005.454-1.31A8.967 8.967 0 0118 9.75v-.7V9A6 6 0 006 9v.75a8.967 8.967 0 01-2.312 6.022c1.733.64 3.56 1.085 5.455 1.31m5.714 0a24.255 24.255 0 01-5.714 0m5.714 0a3 3 0 11-5.714 0" />
                </svg>
                @if (notificationService.unreadCount() > 0) {
                <span
                    class="absolute top-2 right-2.5 w-2.5 h-2.5 bg-red-500 rounded-full border-2 border-white animate-pulse">
                </span>
                }
                }

                @if (isFetchingNotifications) {
                <svg class="animate-spin w-5 h-5 text-indigo-500" xmlns="http://www.w3.org/2000/svg" fill="none"
                    viewBox="0 0 24 24">
                    <circle class="opacity-25" cx="12" cy="12" r="10" stroke="currentColor" stroke-width="4"></circle>
                    <path class="opacity-75" fill="currentColor"
                        d="M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z">
                    </path>
                </svg>
                }
            </button>
        </header>

        <!-- Large Interactive Circular Chart and Details -->
        <div class="flex-1 flex flex-col items-center justify-center min-h-0 mb-4">
            <div class="w-full flex flex-col items-center">
                <!-- Large Circular Chart -->
                <div class="relative w-72 h-72 mb-6">
                    <svg class="w-full h-full transform -rotate-90" viewBox="0 0 200 200">
                        <!-- Track Circles - More visible background tracks -->
                        <circle cx="100" cy="100" r="85" fill="none" stroke="#e2e8f0" stroke-width="18"
                            stroke-linecap="round" />
                        <circle cx="100" cy="100" r="65" fill="none" stroke="#e2e8f0" stroke-width="18"
                            stroke-linecap="round" />
                        <circle cx="100" cy="100" r="45" fill="none" stroke="#e2e8f0" stroke-width="18"
                            stroke-linecap="round" />

                        <!-- Progress Circles - All visible but dynamic opacity -->
                        <circle cx="100" cy="100" r="85" fill="none" stroke="#3b82f6" stroke-width="16"
                            stroke-linecap="round"
                            [attr.stroke-dasharray]="getCircleDashArray(dashboardStats.storage.percentage, 85)"
                            [class.opacity-30]="selectedChartStat !== 'storage'"
                            [class.opacity-100]="selectedChartStat === 'storage'"
                            class="transition-all duration-500 ease-out" />

                        <circle cx="100" cy="100" r="65" fill="none" stroke="#ec4899" stroke-width="16"
                            stroke-linecap="round"
                            [attr.stroke-dasharray]="getCircleDashArray(dashboardStats.cards.percentage, 65)"
                            [class.opacity-30]="selectedChartStat !== 'cards'"
                            [class.opacity-100]="selectedChartStat === 'cards'"
                            class="transition-all duration-500 ease-out" />

                        <circle cx="100" cy="100" r="45" fill="none" stroke="#22c55e" stroke-width="16"
                            stroke-linecap="round"
                            [attr.stroke-dasharray]="getCircleDashArray(dashboardStats.qrs.percentage, 45)"
                            [class.opacity-30]="selectedChartStat !== 'qrs'"
                            [class.opacity-100]="selectedChartStat === 'qrs'"
                            class="transition-all duration-500 ease-out" />
                    </svg>

                    <!-- Dynamic Center Label -->
                    <div class="absolute inset-0 flex flex-col items-center justify-center" style="padding: 1.5rem;">
                        <span class="text-4xl font-black tracking-tight transition-colors duration-300 leading-none"
                            [class.text-blue-600]="selectedChartStat === 'storage'"
                            [class.text-pink-600]="selectedChartStat === 'cards'"
                            [class.text-green-600]="selectedChartStat === 'qrs'">
                            {{getCurrentChartValue().toFixed(0)}}<span class="text-3xl">%</span>
                        </span>
                        <span class="text-sm font-bold text-slate-400 uppercase tracking-wider">{{getCurrentChartLabel()}}</span>
                    </div>
                </div>

                <!-- Interactive Tabs -->
                <div class="flex justify-center gap-3 mb-6">
                    <button (click)="selectChartStat('storage')" 
                        [class]="selectedChartStat === 'storage' ? 'bg-blue-100 text-blue-700 border-blue-400 shadow-md' : 'bg-blue-50 text-blue-600 border-blue-100'"
                        class="flex items-center gap-2 px-4 py-2.5 rounded-full border-2 transition-all hover:scale-105 active:scale-95">
                        <div class="w-3 h-3 rounded-full bg-blue-500"></div>
                        <span class="text-sm font-bold">Storage</span>
                    </button>
                    <button (click)="selectChartStat('cards')" 
                        [class]="selectedChartStat === 'cards' ? 'bg-pink-100 text-pink-700 border-pink-400 shadow-md' : 'bg-pink-50 text-pink-600 border-pink-100'"
                        class="flex items-center gap-2 px-4 py-2.5 rounded-full border-2 transition-all hover:scale-105 active:scale-95">
                        <div class="w-3 h-3 rounded-full bg-pink-500"></div>
                        <span class="text-sm font-bold">Cards</span>
                    </button>
                    <button (click)="selectChartStat('qrs')" 
                        [class]="selectedChartStat === 'qrs' ? 'bg-green-100 text-green-700 border-green-400 shadow-md' : 'bg-green-50 text-green-600 border-green-100'"
                        class="flex items-center gap-2 px-4 py-2.5 rounded-full border-2 transition-all hover:scale-105 active:scale-95">
                        <div class="w-3 h-3 rounded-full bg-green-500"></div>
                        <span class="text-sm font-bold">QRs</span>
                    </button>
                </div>

                <!-- Details Section -->
                <div class="bg-white rounded-2xl p-5 shadow-lg border border-slate-100 w-full max-w-md">
                    <div class="flex justify-between items-center">
                        <div>
                            <p class="text-sm font-bold text-slate-400 uppercase tracking-wider mb-1">{{getSelectedStatDetails().label}} Details</p>
                            <div class="flex items-baseline gap-2">
                                <span class="text-2xl font-black transition-colors duration-300"
                                    [class.text-blue-600]="selectedChartStat === 'storage'"
                                    [class.text-pink-600]="selectedChartStat === 'cards'"
                                    [class.text-green-600]="selectedChartStat === 'qrs'">
                                    {{getSelectedStatDetails().used}}
                                </span>
                                <span class="text-lg font-bold text-slate-500">{{getSelectedStatDetails().unit}}</span>
                                <span class="text-lg font-bold text-slate-400">/</span>
                                <span class="text-xl font-bold text-slate-600">{{getSelectedStatDetails().total}} {{getSelectedStatDetails().unit}}</span>
                            </div>
                        </div>
                        <div class="text-right">
                            <p class="text-xs font-bold text-slate-400 uppercase tracking-wider mb-1">Used</p>
                            <p class="text-2xl font-black transition-colors duration-300"
                                [class.text-blue-600]="selectedChartStat === 'storage'"
                                [class.text-pink-600]="selectedChartStat === 'cards'"
                                [class.text-green-600]="selectedChartStat === 'qrs'">
                                {{getCurrentChartValue().toFixed(0)}}%
                            </p>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <!-- Your Vault Section - Fixed at Bottom -->
        <div class="flex-shrink-0">
            <div class="grid grid-cols-3 gap-3">
                <!-- Documents Card -->
                <div (click)="navigateToDocuments()"
                    class="group relative bg-white rounded-xl p-4 shadow-md border border-slate-100 hover:shadow-lg transition-all duration-300 cursor-pointer active:scale-[0.98] overflow-hidden flex flex-col items-center justify-center">
                    <div class="w-14 h-14 bg-blue-500 rounded-xl flex items-center justify-center text-white shadow-md group-hover:scale-105 transition-transform mb-2">
                        <svg class="w-7 h-7" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="1.5"
                                d="M9 12h6m-6 4h6m2 5H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z" />
                        </svg>
                    </div>
                    <h2 class="text-sm font-bold text-slate-800 group-hover:text-blue-600 transition-colors mb-1 text-center">
                        Documents</h2>
                    <p class="text-xs text-slate-500 group-hover:text-blue-400 text-center">
                        {{totalStats.documents}} Files</p>
                </div>

                <!-- Cards Card -->
                <div (click)="router.navigate(['/cards'])"
                    class="group relative bg-white rounded-xl p-4 shadow-md border border-slate-100 hover:shadow-lg transition-all duration-300 cursor-pointer active:scale-[0.98] overflow-hidden flex flex-col items-center justify-center">
                    <div class="w-14 h-14 bg-pink-500 rounded-xl flex items-center justify-center text-white shadow-md group-hover:scale-105 transition-transform mb-2">
                        <svg class="w-7 h-7" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="1.5"
                                d="M3 10h18M7 15h1m4 0h1m-7 4h12a3 3 0 003-3V8a3 3 0 00-3-3H6a3 3 0 00-3 3v8a3 3 0 003 3z" />
                        </svg>
                    </div>
                    <h2 class="text-sm font-bold text-slate-800 group-hover:text-pink-600 transition-colors mb-1 text-center">
                        Cards</h2>
                    <p class="text-xs text-slate-500 group-hover:text-pink-400 text-center">
                        {{cardsCount}} Active</p>
                </div>

                <!-- QRs Card -->
                <div (click)="router.navigate(['/my-qr'])"
                    class="group relative bg-white rounded-xl p-4 shadow-md border border-slate-100 hover:shadow-lg transition-all duration-300 cursor-pointer active:scale-[0.98] overflow-hidden flex flex-col items-center justify-center">
                    <div class="w-14 h-14 bg-green-500 rounded-xl flex items-center justify-center text-white shadow-md group-hover:scale-105 transition-transform mb-2">
                        <svg class="w-7 h-7" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="1.5"
                                d="M12 4v1m6 11h2m-6 0h-2v4h2v-4zm-6 12v-2m0 0h-2v-2h2v2zm-6 0h2v2h-2v-2zm0-6h2v2h-2v-2zm6 0h-2v2h2v-2zm-6-2h2v2h-2v-2zm0-2h2v2h-2v-2zm0-2h2v2h-2v-2zm6-2h-2v2h2v-2zm0 2h-2v2h2v-2zm0 2h-2v2h2v-2z" />
                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="1.5"
                                d="M3 3h6v6H3V3zm12 0h6v6h-6V3zM3 15h6v6H3v-6z" />
                        </svg>
                    </div>
                    <h2 class="text-sm font-bold text-slate-800 group-hover:text-green-600 transition-colors mb-1 text-center">
                        QRs</h2>
                    <p class="text-xs text-slate-500 group-hover:text-green-400 text-center">
                        Synced</p>
                </div>
            </div>
        </div>
    </div>
</div>
