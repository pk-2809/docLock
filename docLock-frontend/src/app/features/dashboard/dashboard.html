<div class="dashboard-container min-h-screen bg-slate-50 pb-24 text-slate-900 p-4">
    <!-- Header Section -->
    <header class="flex justify-between items-center mb-8 pt-2">
        <div class="welcome-section">
            <h2 class="text-slate-500 text-sm uppercase tracking-wider font-medium mb-1">
                Welcome back,
            </h2>
            <h1 class="text-3xl font-black tracking-tight flex items-center gap-2 text-slate-900">
                {{ firstName }}
                <span class="w-2 h-2 rounded-full bg-green-500"></span>
            </h1>
        </div>

        <!-- Notification Bell -->
        <!-- Notification Bell -->
        <button (click)="onNotificationClick()" [disabled]="isFetchingNotifications"
            class="relative w-12 h-12 rounded-2xl bg-white border border-slate-100 shadow-sm flex items-center justify-center text-slate-400 hover:text-slate-600 transition-colors disabled:opacity-70 disabled:cursor-not-allowed hover:shadow-md">

            <!-- Icon (Hidden when loading) -->
            @if (!isFetchingNotifications) {
            <svg class="w-6 h-6" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="1.5"
                    d="M14.857 17.082a23.848 23.848 0 005.454-1.31A8.967 8.967 0 0118 9.75v-.7V9A6 6 0 006 9v.75a8.967 8.967 0 01-2.312 6.022c1.733.64 3.56 1.085 5.455 1.31m5.714 0a24.255 24.255 0 01-5.714 0m5.714 0a3 3 0 11-5.714 0"/>
            </svg>
            <!-- Badge -->
            @if (notificationService.unreadCount() > 0) {
            <span class="absolute top-2 right-2 w-2.5 h-2.5 bg-red-500 rounded-full border-2 border-white">
            </span>
            }
            }

            <!-- Spinner (Shown when loading) -->
            @if (isFetchingNotifications) {
            <svg class="animate-spin w-5 h-5 text-indigo-500" xmlns="http://www.w3.org/2000/svg" fill="none"
                viewBox="0 0 24 24">
                <circle class="opacity-25" cx="12" cy="12" r="10" stroke="currentColor" stroke-width="4"></circle>
                <path class="opacity-75" fill="currentColor"
                    d="M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z">
                </path>
            </svg>
            }
        </button>
    </header>

    <!-- Storage Widget (Donut Chart visual) -->
    <section class="mb-8">
        <div class="bg-white rounded-3xl p-6 relative overflow-hidden shadow-lg border border-slate-100">
            <div class="flex justify-between items-start relative z-10">
                <div>
                    <h3 class="text-lg font-bold mb-1 text-slate-900">Storage Used</h3>
                    <p class="text-3xl font-black mb-1 text-[#6366f1]">{{ stats.storageUsed }}%</p>
                    <p class="text-xs text-slate-500">{{ stats.images + stats.cards }} files stored</p>
                </div>
                <!-- Circular Progress Mockup -->
                <div class="relative w-16 h-16">
                    <svg class="w-full h-full transform -rotate-90">
                        <circle cx="32" cy="32" r="28" stroke="currentColor" stroke-width="6" fill="none"
                            class="text-slate-200" />
                        <circle cx="32" cy="32" r="28" stroke="currentColor" stroke-width="6" fill="none"
                            class="text-[#6366f1]" stroke-dasharray="175"
                            [attr.stroke-dashoffset]="175 - (175 * stats.storageUsed / 100)" stroke-linecap="round" />
                    </svg>
                    <div class="absolute inset-0 flex items-center justify-center">
                        <svg class="w-6 h-6 text-[#6366f1]" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="1.5"
                                d="M3.75 9.776c.112-.017.227-.026.344-.026h15.812c.117 0 .232.009.344.026m-16.5 0a2.25 2.25 0 00-1.883 2.542l.857 6a2.25 2.25 0 002.227 1.932H19.05a2.25 2.25 0 002.227-1.932l.857-6a2.25 2.25 0 00-1.883-2.542m-16.5 0V6A2.25 2.25 0 016 3.75h3.879a1.5 1.5 0 011.06.44l2.122 2.12a1.5 1.5 0 001.06.44H18A2.25 2.25 0 0120.25 9v.776"/>
                        </svg>
                    </div>
                </div>
            </div>

            <!-- Progress Bar Bottom -->
            <div class="mt-6 w-full h-2 bg-slate-100 rounded-full overflow-hidden">
                <div class="h-full bg-[#6366f1]" [style.width.%]="stats.storageUsed">
                </div>
            </div>

            <!-- Background Decoration -->
            <div class="absolute -right-4 -bottom-4 w-32 h-32 bg-indigo-500/5 rounded-full blur-2xl"></div>
        </div>
    </section>

    <!-- Stats Grid -->
    <section class="grid grid-cols-2 gap-4 mb-8">
        <!-- Documents -->
        <a routerLink="/documents" class="bg-white rounded-3xl p-6 hover:shadow-lg transition-all shadow-lg border border-slate-100 group">
            <div class="w-12 h-12 rounded-2xl bg-blue-50 flex items-center justify-center mb-4 text-[#3b82f6] group-hover:bg-blue-100 transition-colors">
                <svg class="w-7 h-7" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="1.5"
                        d="M19.5 14.25v-2.625a3.375 3.375 0 00-3.375-3.375h-1.5A1.125 1.125 0 0113.5 7.125v-1.5a3.375 3.375 0 00-3.375-3.375H8.25m0 12.75h7.5m-7.5 3H12M10.5 2.25H5.625c-.621 0-1.125.504-1.125 1.125v17.25c0 .621.504 1.125 1.125 1.125h12.75c.621 0 1.125-.504 1.125-1.125V11.25a9 9 0 00-9-9z"/>
                </svg>
            </div>
            <h4 class="text-2xl font-bold mb-1 text-slate-900">{{ stats.images }}</h4>
            <p class="text-sm text-slate-500 font-medium">Documents</p>
        </a>

        <!-- Cards -->
        <button (click)="navigateToCards()" class="bg-white rounded-3xl p-6 hover:shadow-lg transition-all shadow-lg border border-slate-100 group text-left w-full">
            <div class="w-12 h-12 rounded-2xl bg-pink-50 flex items-center justify-center mb-4 text-[#ec4899] group-hover:bg-pink-100 transition-colors">
                <svg class="w-7 h-7" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="1.5"
                        d="M2.25 8.25h19.5M2.25 9h19.5m-16.5 5.25h6m-6 2.25h3m-3.75 3h15a2.25 2.25 0 002.25-2.25V6.75A2.25 2.25 0 0019.5 4.5h-15a2.25 2.25 0 00-2.25 2.25v10.5A2.25 2.25 0 004.5 19.5z"/>
                </svg>
            </div>
            <h4 class="text-2xl font-bold mb-1 text-slate-900">{{ stats.cards }}</h4>
            <p class="text-sm text-slate-500 font-medium">Saved Cards</p>
        </button>

        <!-- Friends -->
        <a routerLink="/friends" class="bg-white rounded-2xl p-4 hover:shadow-md transition-all shadow-sm border border-slate-100 group">
            <div class="w-10 h-10 rounded-xl bg-emerald-50 flex items-center justify-center mb-3 text-emerald-600 group-hover:bg-emerald-100 transition-colors">
                <svg class="w-6 h-6" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="1.5"
                        d="M18 18.72a9.094 9.094 0 003.741-.479 3 3 0 00-4.682-2.72m.94 3.198l.001.031c0 .225-.012.447-.037.666A11.944 11.944 0 0112 21c-2.17 0-4.207-.576-5.963-1.584A6.062 6.062 0 016 18.719m12 0a5.971 5.971 0 00-.941-3.197m0 0A5.995 5.995 0 0012 12.75a5.995 5.995 0 00-5.058 2.772m0 0a3 3 0 00-4.681 2.72 8.986 8.986 0 003.74.477m.94-3.197a5.971 5.971 0 00-.94 3.197M15 6.75a3 3 0 11-6 0 3 3 0 016 0zm6 3a2.25 2.25 0 11-4.5 0 2.25 2.25 0 014.5 0zm-13.5 0a2.25 2.25 0 11-4.5 0 2.25 2.25 0 014.5 0z"/>
                </svg>
            </div>
            <h4 class="text-2xl font-bold mb-1 text-slate-900">{{ stats.friends }}</h4>
            <p class="text-xs text-slate-500 font-medium">Friends</p>
        </a>

        <!-- Shared -->
        <a routerLink="/friends" class="bg-white rounded-2xl p-4 hover:shadow-md transition-all shadow-sm border border-slate-100 group">
            <div class="w-10 h-10 rounded-xl bg-amber-50 flex items-center justify-center mb-3 text-amber-600 group-hover:bg-amber-100 transition-colors">
                <svg class="w-6 h-6" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="1.5"
                        d="M7.217 10.907a2.25 2.25 0 100 2.186m0-2.186c.18.324.283.696.283 1.093s-.103.77-.283 1.093m0-2.186l9.566-5.314m-9.566 7.5l9.566 5.314m0 0a2.25 2.25 0 103.935 2.186 2.25 2.25 0 00-3.935-2.186zm0-12.814a2.25 2.25 0 103.933-2.185 2.25 2.25 0 00-3.933 2.185z"/>
                </svg>
            </div>
            <h4 class="text-2xl font-bold mb-1 text-slate-900">{{ stats.shared }}</h4>
            <p class="text-xs text-slate-500 font-medium">Shared Files</p>
        </a>
    </section>

    <!-- Quick Actions (Horizontal Scroll) -->
    <section>
        <h3 class="text-slate-500 text-xs font-bold uppercase tracking-wider mb-4">Quick Actions</h3>
        <div class="flex gap-4 overflow-x-auto pb-4 -mx-4 px-4 scrollbar-hide">
            <!-- Scan QR -->
            <a routerLink="/scan"
                class="flex-shrink-0 w-32 h-36 bg-white rounded-2xl p-4 flex flex-col items-center justify-center gap-3 relative overflow-hidden group shadow-sm border border-slate-100 hover:shadow-md transition-all">
                <div
                    class="w-12 h-12 rounded-full bg-indigo-50 flex items-center justify-center group-hover:scale-110 transition-transform group-hover:bg-indigo-100">
                    <svg class="w-6 h-6 text-indigo-600" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="1.5"
                            d="M3.75 4.875c0-.621.504-1.125 1.125-1.125h4.5c.621 0 1.125.504 1.125 1.125v4.5c0 .621-.504 1.125-1.125 1.125h-4.5A1.125 1.125 0 013.75 9.375v-4.5zM3.75 14.625c0-.621.504-1.125 1.125-1.125h4.5c.621 0 1.125.504 1.125 1.125v4.5c0 .621-.504 1.125-1.125 1.125h-4.5a1.125 1.125 0 01-1.125-1.125v-4.5zM13.5 4.875c0-.621.504-1.125 1.125-1.125h4.5c.621 0 1.125.504 1.125 1.125v4.5c0 .621-.504 1.125-1.125 1.125h-4.5A1.125 1.125 0 0113.5 9.375v-4.5z"/>
                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="1.5" d="M6.75 6.75h.75v.75h-.75v-.75zM6.75 16.5h.75v.75h-.75v-.75zM16.5 6.75h.75v.75h-.75v-.75zM13.5 13.5h3.75v3.75H13.5V13.5z"/>
                    </svg>
                </div>
                <span class="text-sm font-bold text-slate-700">Scan QR</span>
                <div
                    class="absolute bottom-0 left-0 w-full h-1 bg-indigo-500 scale-x-0 group-hover:scale-x-100 transition-transform rounded-b-2xl">
                </div>
            </a>

            <!-- Upload -->
            <button
                class="flex-shrink-0 w-32 h-36 bg-white rounded-2xl p-4 flex flex-col items-center justify-center gap-3 relative overflow-hidden group shadow-sm border border-slate-100 hover:shadow-md transition-all">
                <div
                    class="w-12 h-12 rounded-full bg-pink-50 flex items-center justify-center group-hover:scale-110 transition-transform group-hover:bg-pink-100">
                    <svg class="w-6 h-6 text-pink-600" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="1.5"
                            d="M3 16.5v2.25A2.25 2.25 0 005.25 21h13.5A2.25 2.25 0 0021 18.75V16.5m-13.5-9L12 3m0 0l4.5 4.5M12 3v13.5"/>
                    </svg>
                </div>
                <span class="text-sm font-bold text-slate-700">Upload</span>
                <div
                    class="absolute bottom-0 left-0 w-full h-1 bg-pink-500 scale-x-0 group-hover:scale-x-100 transition-transform rounded-b-2xl">
                </div>
            </button>

            <!-- Search -->
            <button
                class="flex-shrink-0 w-32 h-36 bg-white rounded-2xl p-4 flex flex-col items-center justify-center gap-3 relative overflow-hidden group shadow-sm border border-slate-100 hover:shadow-md transition-all">
                <div
                    class="w-12 h-12 rounded-full bg-emerald-50 flex items-center justify-center group-hover:scale-110 transition-transform group-hover:bg-emerald-100">
                    <svg class="w-6 h-6 text-emerald-600" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="1.5" d="M21 21l-5.197-5.197m0 0A7.5 7.5 0 105.196 5.196a7.5 7.5 0 0010.607 10.607z"/>
                    </svg>
                </div>
                <span class="text-sm font-bold text-slate-700">Search</span>
                <div
                    class="absolute bottom-0 left-0 w-full h-1 bg-emerald-500 scale-x-0 group-hover:scale-x-100 transition-transform rounded-b-2xl">
                </div>
            </button>
        </div>
    </section>
</div>